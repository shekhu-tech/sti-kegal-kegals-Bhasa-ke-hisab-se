<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>S.T.I-KEGAL Pro | Pelvic Health Partner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        
        :root {
            --gold-light: #FFD700;
            --gold-primary: #D4AF37;
            --gold-secondary: #B8860B;
            --gold-dark: #996515;
            --black-deep: #0A0A0A;
            --black-surface: #121212;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body { 
            font-family: 'Inter', -apple-system, sans-serif; 
            background: #000000;
            color: #ffffff;
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            text-rendering: optimizeLegibility;
        }

        .background-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -10;
            background: linear-gradient(145deg, #000000 70%, rgba(212, 175, 55, 0.05) 100%);
        }
        
        .quiz-background, .analysis-background, .exercise-background, .modal-background, .question-popup-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.7;
            z-index: -9;
        }

        .main-container {
            background: rgba(10, 10, 10, 0.85);
            border: 1px solid rgba(212, 175, 55, 0.25);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.9), 0 0 24px rgba(212, 175, 55, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
        }

        .text-3d-gold {
            text-shadow: 0 1px 0 rgba(255, 255, 255, 0.1), 0 3px 0 rgba(212, 175, 55, 0.1), 0 5px 10px rgba(0, 0, 0, 0.25);
            color: var(--gold-light);
        }

        .gold-btn {
            background: linear-gradient(135deg, var(--gold-secondary) 0%, var(--gold-primary) 100%);
            color: #000;
            font-weight: 800;
            box-shadow: 0 4px 0 var(--gold-dark), 0 6px 10px rgba(212, 175, 55, 0.3);
            transition: all 0.2s ease;
        }
        
        .gold-btn:active { transform: translateY(2px); box-shadow: 0 2px 0 var(--gold-dark); }

        .option-btn {
            background: rgba(20, 20, 20, 0.95);
            border: 1px solid rgba(212, 175, 55, 0.2);
            transition: all 0.2s ease;
        }
        
        .option-btn:active { border-color: var(--gold-primary); background: rgba(212, 175, 55, 0.12); }

        .exercise-card {
            background: rgba(20, 20, 20, 0.9);
            border: 1px solid rgba(212, 175, 55, 0.1);
            transition: all 0.3s ease;
        }
        
        .exercise-card.current { border-color: var(--gold-primary); box-shadow: 0 0 20px rgba(212, 175, 55, 0.15); }
        .exercise-card.locked { opacity: 0.4; pointer-events: none; }
        .exercise-card.completed { border-color: #10B981; background: rgba(16, 185, 129, 0.05); }

        .progress-bar {
            background: linear-gradient(90deg, var(--gold-secondary), var(--gold-primary));
            height: 8px;
            border-radius: 10px;
            transition: width 0.4s ease;
        }

        .video-container {
            background: #000;
            border-radius: 16px;
            border: 2px solid var(--gold-primary);
            overflow: hidden;
        }

        .aspect-ratio-16-9 { position: relative; padding-top: 56.25%; }
        .aspect-ratio-16-9 iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        .custom-scrollbar::-webkit-scrollbar { width: 4px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: var(--gold-primary); border-radius: 10px; }

        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .scrollable-content { max-height: 70vh; overflow-y: auto; }
        
        .video-progress {
            height: 4px;
            background: rgba(212, 175, 55, 0.3);
            border-radius: 2px;
            overflow: hidden;
        }
        
        .video-progress-fill {
            height: 100%;
            background: var(--gold-primary);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class="flex items-center justify-center p-0">
    <div class="background-layer"></div>
    <div class="quiz-background" id="quiz-bg"></div>
    <div class="analysis-background hidden" id="analysis-bg"></div>
    <div class="exercise-background hidden" id="exercise-bg"></div>
    
    <div class="w-full min-h-screen safe-area-top safe-area-bottom flex items-center justify-center px-3">
        <div class="w-full max-w-md main-container rounded-xl p-4 fade-in">
            
            <header class="text-center mb-6">
                <h1 class="text-2xl font-black text-3d-gold tracking-tight">S.T.I-KEGAL PRO</h1>
                <p class="text-[10px] text-gold-light/60 font-bold uppercase tracking-wider">PELVIC HEALTH PARTNER</p>
            </header>

            <div class="scrollable-content custom-scrollbar">
                <main id="app-content">
                    <!-- Progress -->
                    <div id="progress-section" class="mb-5">
                        <div class="flex justify-between items-center mb-2">
                            <span id="step-label" class="text-[10px] font-bold text-gold-light uppercase">Assessment</span>
                            <span id="question-counter" class="text-[10px] font-bold text-white">1/50</span>
                        </div>
                        <div class="w-full bg-black/50 h-2 rounded-full overflow-hidden">
                            <div id="progress-bar" class="progress-bar w-0"></div>
                        </div>
                    </div>

                    <!-- Quiz Section -->
                    <div id="quiz-section" class="fade-in">
                        <h2 id="question-text" class="text-lg font-bold text-white mb-5 leading-tight"></h2>
                        <div id="options-container" class="space-y-2.5"></div>
                    </div>

                    <!-- Analysis Section -->
                    <div id="analysis-section" class="hidden text-center fade-in">
                        <h2 class="text-xl font-black text-3d-gold mb-2">Assessment Complete!</h2>
                        <p class="text-xs text-gray-400 mb-6">Your Personalized Medical Report</p>
                        
                        <div class="grid grid-cols-3 gap-3 mb-6">
                            <div class="bg-white/5 p-4 rounded-lg border border-gold-primary/10">
                                <div class="text-[9px] uppercase text-gray-500 mb-2">Focus</div>
                                <div id="focus-score" class="text-lg font-black text-gold-light">--</div>
                            </div>
                            <div class="bg-white/5 p-4 rounded-lg border border-gold-primary/10">
                                <div class="text-[9px] uppercase text-gray-500 mb-2">Urgency</div>
                                <div id="urgency-score" class="text-lg font-black text-gold-light">--</div>
                            </div>
                            <div class="bg-white/5 p-4 rounded-lg border border-gold-primary/10">
                                <div class="text-[9px] uppercase text-gray-500 mb-2">Protocol</div>
                                <div id="program-score" class="text-lg font-black text-gold-light">--</div>
                            </div>
                        </div>
                        
                        <div class="bg-gold-primary/5 p-4 rounded-lg border border-gold-primary/20 mb-6 text-left">
                            <h3 class="text-sm font-bold text-white mb-2 flex items-center">
                                <i class="fas fa-stethoscope text-gold-primary mr-2"></i> Medical Prescription
                            </h3>
                            <p id="analysis-text" class="text-xs text-gray-300 leading-relaxed"></p>
                        </div>
                        
                        <button onclick="showExercisePlan()" class="w-full gold-btn py-4 rounded-lg text-sm font-bold">
                            VIEW PRESCRIBED PROTOCOL
                        </button>
                    </div>

                    <!-- Exercise Plan Section -->
                    <div id="exercise-section" class="hidden fade-in">
                        <div class="flex justify-between items-center mb-5">
                            <div>
                                <h2 class="text-lg font-bold text-white">Daily Protocol</h2>
                                <span class="text-[10px] text-gold-primary font-bold">Day <span id="current-day">1</span> of 30</span>
                            </div>
                            <div id="completion-stats" class="text-[10px] text-gray-400 font-bold">0/6 Completed</div>
                        </div>
                        
                        <div id="exercise-list" class="space-y-3 pb-4"></div>
                        
                        <button onclick="restartAssessment()" class="w-full mt-4 py-3 bg-black/50 border border-gold-primary/30 text-gold-primary rounded-lg text-[10px] font-bold uppercase">
                            <i class="fas fa-redo mr-2"></i> Reset Assessment
                        </button>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <!-- Video Modal -->
    <div id="video-modal" class="fixed inset-0 z-50 hidden flex flex-col items-center justify-center p-4">
        <div class="absolute inset-0 bg-black/95 backdrop-blur-sm" onclick="closeVideoModal()"></div>
        <div class="w-full max-w-md z-10">
            <div class="video-container mb-4">
                <div class="aspect-ratio-16-9" id="video-frame"></div>
                <div class="p-3 bg-black/80">
                    <div class="video-progress mb-2">
                        <div id="video-progress-fill" class="video-progress-fill"></div>
                    </div>
                    <div class="flex justify-between text-[10px] text-gray-400">
                        <span id="video-time-current">0:00</span>
                        <span id="video-time-total">0:00</span>
                    </div>
                </div>
            </div>
            <div class="bg-black/90 p-5 rounded-xl border border-gold-primary/20">
                <h3 id="video-title" class="text-sm font-bold text-white mb-2"></h3>
                <p id="video-description" class="text-[11px] text-gray-400 mb-4"></p>
                <div class="flex justify-between text-[10px] text-gray-500 mb-6">
                    <span><i class="fas fa-clock mr-1"></i> <span id="video-duration"></span></span>
                    <span><i class="fas fa-redo mr-1"></i> <span id="video-reps"></span></span>
                    <span id="video-category" class="text-gold-primary uppercase font-bold"></span>
                </div>
                <button id="complete-btn" onclick="markCurrentExerciseComplete()" class="w-full gold-btn py-3.5 rounded-lg text-xs font-bold" disabled>
                    <i class="fas fa-spinner fa-spin mr-2 hidden" id="video-loading"></i>
                    <span id="complete-btn-text">VIDEO MUST BE COMPLETED FIRST</span>
                </button>
            </div>
        </div>
    </div>

<script>
    // ==================== STATE MANAGEMENT ====================
    let appState = {
        currentQuestion: 0,
        gender: null,
        scores: { leakage: 0, pain: 0, sexual: 0, strength: 0, control: 0 },
        categoryScores: { demographic: 0, symptoms: 0, lifestyle: 0, sexual: 0, experience: 0, goals: 0, medical: 0 },
        assessmentComplete: false,
        currentDay: 1,
        dayExercises: {}, 
        dayProgress: {},  
        userProfile: {},
        lastSave: Date.now(),
        videoProgress: {}
    };

    // ==================== STORAGE FUNCTIONS ====================
    function saveState() {
        appState.lastSave = Date.now();
        localStorage.setItem('STI_KEGAL_PRO_DATA', JSON.stringify(appState));
    }

    function loadState() {
        const saved = localStorage.getItem('STI_KEGAL_PRO_DATA');
        if (saved) {
            appState = JSON.parse(saved);
            return true;
        }
        return false;
    }

    // ==================== MASSIVE EXERCISE LIBRARY ====================
    const exerciseLibrary = {
        control:[
{ id:"C1",name:"Elevator Wave Control",description:"Gradual intensity levels",category:"control",subcategory:"wave",difficulty:"intermediate",duration:"4:10",reps:"6 full waves",videoCode:"dQw4w9WgXcQ",benefit:"Precise intensity control. Fine motor skills.",solution:"Teaches graded muscle contraction control.",gender:"both"},
{ id:"C2",name:"Front-to-Back Sequencing",description:"Sequential muscle activation",category:"control",subcategory:"wave",difficulty:"intermediate",duration:"4:30",reps:"8 sequences",videoCode:"dQw4w9WgXcQ",benefit:"Muscle isolation. Selective control.",solution:"Trains separate control of different pelvic areas.",gender:"both"},
{ id:"C3",name:"Rolling Pelvic Wave",description:"Circular muscle engagement",category:"control",subcategory:"wave",difficulty:"advanced",duration:"4:45",reps:"6 rolling waves",videoCode:"dQw4w9WgXcQ",benefit:"Complete muscle control. 360° engagement.",solution:"Comprehensive pelvic muscle coordination.",gender:"both"},
{ id:"C4",name:"Stop-Start Precision",description:"Rapid on-off control",category:"control",subcategory:"stop-start",difficulty:"intermediate",duration:"3:45",reps:"12 precision reps",videoCode:"dQw4w9WgXcQ",benefit:"Immediate control. Quick response.",solution:"Trains rapid muscle activation/deactivation.",gender:"both"},
{ id:"C5",name:"Interrupted Flow Training",description:"Urinary flow control practice",category:"control",subcategory:"stop-start",difficulty:"intermediate",duration:"4:15",reps:"8 interruptions",videoCode:"dQw4w9WgXcQ",benefit:"Practical bladder control. Real-world application.",solution:"Direct training for urinary control.",gender:"both"},
{ id:"C6",name:"Multi-Level Coordination",description:"Complex control patterns",category:"control",subcategory:"wave",difficulty:"advanced",duration:"5:00",reps:"5 patterns",videoCode:"dQw4w9WgXcQ",benefit:"Advanced coordination. Master-level control.",solution:"Develops sophisticated muscle coordination.",gender:"both"},
{ id:"C7",name:"Precision Control Mastery",description:"Advanced control techniques",category:"control",subcategory:"wave",difficulty:"advanced",duration:"4:55",reps:"8 mastery reps",videoCode:"dQw4w9WgXcQ",benefit:"Master-level control. Precision skills.",solution:"Advanced training for precise muscle control.",gender:"both"},
{ id:"C8",name:"Rhythmic Control Patterns",description:"Complex rhythmic patterns",category:"control",subcategory:"stop-start",difficulty:"intermediate",duration:"4:20",reps:"10 rhythmic patterns",videoCode:"dQw4w9WgXcQ",benefit:"Rhythmic control. Pattern recognition.",solution:"Develops rhythmic control patterns.",gender:"both"}
],

functional:[
{ id:"FU1",name:"Walking Integration",description:"Kegels while walking",category:"functional",subcategory:"activity-linked",difficulty:"beginner",duration:"3:30",reps:"During 5-min walk",videoCode:"dQw4w9WgXcQ",benefit:"Real-world application. Daily life integration.",solution:"Trains pelvic control during movement.",gender:"both"},
{ id:"FU2",name:"Sitting Posture Kegels",description:"Engage while sitting properly",category:"functional",subcategory:"activity-linked",difficulty:"beginner",duration:"3:15",reps:"10 sitting reps",videoCode:"dQw4w9WgXcQ",benefit:"Posture correction. Desk job solution.",solution:"Combines pelvic health with posture correction.",gender:"both"},
{ id:"FU3",name:"Standing Stability",description:"Pelvic engagement while standing",category:"functional",subcategory:"activity-linked",difficulty:"beginner",duration:"3:00",reps:"8 standing reps",videoCode:"dQw4w9WgXcQ",benefit:"Standing stability. Core integration.",solution:"Improves stability during standing activities.",gender:"both"},
{ id:"FU4",name:"Cough Guard Reflex",description:"Pre-activation before cough/sneeze",category:"functional",subcategory:"stress-response",difficulty:"beginner",duration:"2:45",reps:"10 reflex reps",videoCode:"dQw4w9WgXcQ",benefit:"Leakage prevention. Stress incontinence solution.",solution:"Trains protective reflex for cough/sneeze.",gender:"both"},
{ id:"FU5",name:"Laugh Guard Protection",description:"Control during laughter",category:"functional",subcategory:"stress-response",difficulty:"intermediate",duration:"3:20",reps:"8 laugh reps",videoCode:"dQw4w9WgXcQ",benefit:"Social confidence. Laughter control.",solution:"Prevents leakage during laughter.",gender:"both"},
{ id:"FU6",name:"Lift Support Training",description:"Engage during lifting",category:"functional",subcategory:"stress-response",difficulty:"intermediate",duration:"3:45",reps:"6 lift reps",videoCode:"dQw4w9WgXcQ",benefit:"Heavy load protection. Core stability.",solution:"Protects pelvic floor during heavy lifting.",gender:"both"},
{ id:"FU7",name:"Car Driving Integration",description:"Kegels while driving",category:"functional",subcategory:"activity-linked",difficulty:"beginner",duration:"3:10",reps:"During 10-min drive",videoCode:"dQw4w9WgXcQ",benefit:"Daily commute training. Time efficiency.",solution:"Utilizes driving time for pelvic training.",gender:"both"},
{ id:"FU8",name:"Desk Work Integration",description:"Office-friendly kegels",category:"functional",subcategory:"activity-linked",difficulty:"beginner",duration:"3:25",reps:"15 desk reps",videoCode:"dQw4w9WgXcQ",benefit:"Office-friendly. Discreet training.",solution:"Allows training during office hours.",gender:"both"}
],

breathing:[
{ id:"B1",name:"Diaphragmatic Synchronization",description:"Coordination with deep breathing",category:"breathing",subcategory:"breath-sync",difficulty:"intermediate",duration:"4:15",reps:"10 breath cycles",videoCode:"dQw4w9WgXcQ",benefit:"Breath-muscle harmony. Stress reduction.",solution:"Integrates pelvic health with breathing patterns.",gender:"both"},
{ id:"B2",name:"Inhale Relax/Exhale Contract",description:"Natural breathing rhythm",category:"breathing",subcategory:"breath-sync",difficulty:"beginner",duration:"3:30",reps:"12 natural cycles",videoCode:"dQw4w9WgXcQ",benefit:"Automatic integration. Relaxation response.",solution:"Makes pelvic exercises natural and automatic.",gender:"both"},
{ id:"B3",name:"Mula Bandha Mastery",description:"Yogic root lock technique",category:"breathing",subcategory:"pranayama",difficulty:"advanced",duration:"5:00",reps:"8 yogic holds",videoCode:"dQw4w9WgXcQ",benefit:"Energy control. Deep mind-body connection.",solution:"Traditional yogic technique for pelvic health.",gender:"both"},
{ id:"B4",name:"Root Lock Energy Flow",description:"Energy awareness with breath",category:"breathing",subcategory:"pranayama",difficulty:"advanced",duration:"4:45",reps:"6 energy flows",videoCode:"dQw4w9WgXcQ",benefit:"Energetic awareness. Vitality enhancement.",solution:"Combines physical and energetic aspects.",gender:"both"},
{ id:"B5",name:"4-7-8 Breathing Pattern",description:"Therapeutic breathing rhythm",category:"breathing",subcategory:"breath-sync",difficulty:"intermediate",duration:"4:30",reps:"5 breathing patterns",videoCode:"dQw4w9WgXcQ",benefit:"Anxiety reduction. Deep relaxation.",solution:"Therapeutic breathing for pelvic relaxation.",gender:"both"},
{ id:"B6",name:"Breath Control Mastery",description:"Advanced breath coordination",category:"breathing",subcategory:"breath-sync",difficulty:"advanced",duration:"5:15",reps:"8 mastery cycles",videoCode:"dQw4w9WgXcQ",benefit:"Advanced coordination. Deep control.",solution:"Master-level breath-pelvic coordination.",gender:"both"},
{ id:"B7",name:"Relaxation Breathing",description:"Stress-reduction breathing",category:"breathing",subcategory:"pranayama",difficulty:"beginner",duration:"4:05",reps:"10 relaxation cycles",videoCode:"dQw4w9WgXcQ",benefit:"Stress reduction. Muscle relaxation.",solution:"Promotes relaxation in pelvic muscles.",gender:"both"},
{ id:"B8",name:"Power Breathing Technique",description:"Strength-building breath work",category:"breathing",subcategory:"breath-sync",difficulty:"intermediate",duration:"4:40",reps:"8 power breaths",videoCode:"dQw4w9WgXcQ",benefit:"Power enhancement. Strength building.",solution:"Uses breathing to enhance contraction power.",gender:"both"}
],

sexual:[
{ id:"SPM1",name:"Erectile Strength Builder",description:"Specific for erectile quality improvement",category:"sexual",subcategory:"male",difficulty:"intermediate",duration:"4:00",reps:"10 erectile reps",videoCode:"dQw4w9WgXcQ",benefit:"Improved erection quality. Enhanced stiffness.",solution:"Specifically targets erectile muscle groups in males.",gender:"Male"},
{ id:"SPM2",name:"Ejaculation Control Mastery",description:"Timing and control training for males",category:"sexual",subcategory:"male",difficulty:"advanced",duration:"4:30",reps:"8 control reps",videoCode:"dQw4w9WgXcQ",benefit:"Extended duration. Better ejaculation control.",solution:"Trains control over ejaculation reflex in males.",gender:"Male"},
{ id:"SPM3",name:"Prostate Health Circulation",description:"Prostate-specific blood flow improvement",category:"sexual",subcategory:"male",difficulty:"intermediate",duration:"3:45",reps:"10 prostate reps",videoCode:"dQw4w9WgXcQ",benefit:"Prostate health. Improved circulation.",solution:"Promotes prostate health through exercise for males.",gender:"Male"},
{ id:"SPM4",name:"Male Sexual Stamina",description:"Endurance training for sexual performance",category:"sexual",subcategory:"male",difficulty:"advanced",duration:"4:20",reps:"8 stamina reps",videoCode:"dQw4w9WgXcQ",benefit:"Increased stamina. Longer performance.",solution:"Builds sexual endurance specifically for males.",gender:"Male"},
{ id:"SPM5",name:"Male Pelvic Power",description:"Power training for male sexual function",category:"sexual",subcategory:"male",difficulty:"intermediate",duration:"4:10",reps:"10 power reps",videoCode:"dQw4w9WgXcQ",benefit:"Enhanced power. Stronger contractions.",solution:"Develops power in male pelvic muscles.",gender:"Male"},
{ id:"SPM6",name:"Male Recovery Boost",description:"Post-activity recovery enhancement",category:"sexual",subcategory:"male",difficulty:"beginner",duration:"3:50",reps:"8 recovery reps",videoCode:"dQw4w9WgXcQ",benefit:"Faster recovery. Reduced refractory period.",solution:"Improves recovery time specifically for males.",gender:"Male"},
{ id:"SPF1",name:"Vaginal Tightening & Tone",description:"Tone and sensation enhancement for women",category:"sexual",subcategory:"female",difficulty:"intermediate",duration:"4:15",reps:"12 tightening reps",videoCode:"dQw4w9WgXcQ",benefit:"Increased sensation. Enhanced tightness.",solution:"Specifically for vaginal muscle tone in females.",gender:"Female"},
{ id:"SPF2",name:"Orgasm Intensity Amplifier",description:"Enhances orgasmic experience for women",category:"sexual",subcategory:"female",difficulty:"advanced",duration:"4:45",reps:"6 intensity reps",videoCode:"dQw4w9WgXcQ",benefit:"Stronger orgasms. Better control.",solution:"Trains muscles involved in female orgasm.",gender:"Female"},
{ id:"SPF3",name:"Female Arousal Enhancement",description:"Improves arousal and lubrication",category:"sexual",subcategory:"female",difficulty:"intermediate",duration:"4:05",reps:"10 arousal reps",videoCode:"dQw4w9WgXcQ",benefit:"Enhanced arousal. Natural lubrication.",solution:"Promotes arousal response in females.",gender:"Female"},
{ id:"SPF4",name:"G-Spot Awareness Training",description:"G-spot muscle control for women",category:"sexual",subcategory:"female",difficulty:"advanced",duration:"4:30",reps:"8 G-spot reps",videoCode:"dQw4w9WgXcQ",benefit:"G-spot sensitivity. Enhanced pleasure.",solution:"Develops control over G-spot muscles.",gender:"Female"},
{ id:"SPF5",name:"Female Sexual Confidence",description:"Confidence-building exercises",category:"sexual",subcategory:"female",difficulty:"beginner",duration:"3:55",reps:"10 confidence reps",videoCode:"dQw4w9WgXcQ",benefit:"Increased confidence. Better body awareness.",solution:"Builds sexual confidence specifically for females.",gender:"Female"},
{ id:"SPF6",name:"Postpartum Sexual Recovery",description:"Sexual function recovery after childbirth",category:"sexual",subcategory:"female",difficulty:"intermediate",duration:"4:15",reps:"8 recovery reps",videoCode:"dQw4w9WgXcQ",benefit:"Postpartum recovery. Restored function.",solution:"Specifically designed for postpartum sexual recovery.",gender:"Female"}
],

rehab:[
{ id:"R1",name:"Post-Delivery Gentle Start",description:"Safe postpartum beginning",category:"rehab",subcategory:"post-surgery",difficulty:"beginner",duration:"3:30",reps:"8 gentle reps",videoCode:"dQw4w9WgXcQ",benefit:"Safe recovery. Gradual rebuilding.",solution:"Specifically designed for postpartum recovery.",gender:"Female"},
{ id:"R2",name:"Post-Prostate Surgery Recovery",description:"Post-surgical recovery protocol for men",category:"rehab",subcategory:"post-surgery",difficulty:"beginner",duration:"4:00",reps:"10 recovery reps",videoCode:"dQw4w9WgXcQ",benefit:"Surgical recovery. Function restoration.",solution:"Tailored for post-prostate surgery recovery in males.",gender:"Male"},
{ id:"R3",name:"Urge Suppression Training",description:"Controls sudden urges",category:"rehab",subcategory:"incontinence",difficulty:"intermediate",duration:"4:15",reps:"10 suppression holds",videoCode:"dQw4w9WgXcQ",benefit:"Reduces urgency. Better control.",solution:"Specifically for urge incontinence.",gender:"both"},
{ id:"R4",name:"Stress Leakage Prevention",description:"Prevents leakage under stress",category:"rehab",subcategory:"incontinence",difficulty:"intermediate",duration:"3:45",reps:"8 stress reps",videoCode:"dQw4w9WgXcQ",benefit:"Confidence in movement. No more leaks.",solution:"Targets stress incontinence specifically.",gender:"both"},
{ id:"R5",name:"Bowel Control Training",description:"Improves anal sphincter control",category:"rehab",subcategory:"incontinence",difficulty:"intermediate",duration:"4:30",reps:"10 bowel reps",videoCode:"dQw4w9WgXcQ",benefit:"Better bowel control. Reduced accidents.",solution:"Specifically for fecal incontinence.",gender:"both"},
{ id:"R6",name:"Pelvic Injury Recovery",description:"General pelvic rehabilitation",category:"rehab",subcategory:"post-surgery",difficulty:"beginner",duration:"4:00",reps:"8 rehab reps",videoCode:"dQw4w9WgXcQ",benefit:"Injury recovery. Function restoration.",solution:"General protocol for pelvic injury recovery.",gender:"both"},
{ id:"R7",name:"Male Post-Surgical Protocol",description:"Male-specific post-surgery rehabilitation",category:"rehab",subcategory:"post-surgery",difficulty:"beginner",duration:"4:20",reps:"10 male rehab reps",videoCode:"dQw4w9WgXcQ",benefit:"Male surgical recovery. Faster healing.",solution:"Specifically designed for male post-surgical recovery.",gender:"Male"},
{ id:"R8",name:"Female Post-Surgical Protocol",description:"Female-specific post-surgery rehabilitation",category:"rehab",subcategory:"post-surgery",difficulty:"beginner",duration:"4:25",reps:"10 female rehab reps",videoCode:"dQw4w9WgXcQ",benefit:"Female surgical recovery. Gentle healing.",solution:"Specifically designed for female post-surgical recovery.",gender:"Female"},
{ id:"R9",name:"Chronic Pain Management",description:"Pain relief techniques",category:"rehab",subcategory:"pain-management",difficulty:"intermediate",duration:"4:40",reps:"8 pain relief reps",videoCode:"dQw4w9WgXcQ",benefit:"Pain reduction. Improved comfort.",solution:"Techniques for managing chronic pelvic pain.",gender:"both"},
{ id:"R10",name:"Recovery Progression System",description:"Structured recovery program",category:"rehab",subcategory:"post-surgery",difficulty:"intermediate",duration:"5:00",reps:"Progressive recovery",videoCode:"dQw4w9WgXcQ",benefit:"Structured recovery. Measurable progress.",solution:"Systematic approach to rehabilitation.",gender:"both"}
],

endurance:[
{ id:"E1",name:"30-Second Marathon Hold",description:"Extended duration challenge",category:"endurance",subcategory:"long-duration",difficulty:"intermediate",duration:"5:30",reps:"4 × 30s holds",videoCode:"dQw4w9WgXcQ",benefit:"Extended endurance. Muscle stamina.",solution:"Builds capacity for sustained contraction.",gender:"both"},
{ id:"E2",name:"1-Minute Ultimate Hold",description:"Maximum endurance challenge",category:"endurance",subcategory:"long-duration",difficulty:"advanced",duration:"6:45",reps:"3 × 60s holds",videoCode:"dQw4w9WgXcQ",benefit:"Maximum endurance. Peak stamina.",solution:"Ultimate endurance building exercise.",gender:"both"},
{ id:"E3",name:"High-Rep Endurance (50+)",description:"High repetition training",category:"endurance",subcategory:"repetition",difficulty:"advanced",duration:"7:00",reps:"50+ reps",videoCode:"dQw4w9WgXcQ",benefit:"Repetition endurance. Fatigue resistance.",solution:"Builds resistance to muscle fatigue.",gender:"both"},
{ id:"E4",name:"Ladder Progression (10-20-30)",description:"Systematic increase in reps",category:"endurance",subcategory:"repetition",difficulty:"intermediate",duration:"5:15",reps:"Ladder sets",videoCode:"dQw4w9WgXcQ",benefit:"Structured progression. Measurable gains.",solution:"Systematic approach to endurance building.",gender:"both"},
{ id:"E5",name:"Endurance-Power Combo",description:"Combines endurance and strength",category:"endurance",subcategory:"long-duration",difficulty:"advanced",duration:"6:30",reps:"5 combo reps",videoCode:"dQw4w9WgXcQ",benefit:"Complete development. Balanced capacity.",solution:"Combines endurance and strength training.",gender:"both"},
{ id:"E6",name:"Stamina Builder Pro",description:"Professional stamina training",category:"endurance",subcategory:"long-duration",difficulty:"advanced",duration:"6:15",reps:"6 stamina reps",videoCode:"dQw4w9WgXcQ",benefit:"Professional stamina. Competition-level.",solution:"Advanced stamina building techniques.",gender:"both"},
{ id:"E7",name:"Endurance Circuit Training",description:"Circuit-based endurance",category:"endurance",subcategory:"repetition",difficulty:"intermediate",duration:"5:45",reps:"Circuit training",videoCode:"dQw4w9WgXcQ",benefit:"Circuit endurance. Variety training.",solution:"Circuit training approach to endurance.",gender:"both"},
{ id:"E8",name:"Fatigue Resistance Protocol",description:"Builds resistance to fatigue",category:"endurance",subcategory:"long-duration",difficulty:"advanced",duration:"6:50",reps:"8 fatigue reps",videoCode:"dQw4w9WgXcQ",benefit:"Fatigue resistance. Lasting endurance.",solution:"Specifically targets fatigue resistance.",gender:"both"}
],

mindfulness:[
{ id:"M1",name:"Flower Visualization",description:"Imagine opening/closing flower",category:"mindfulness",subcategory:"imagery",difficulty:"beginner",duration:"3:45",reps:"8 visualizations",videoCode:"dQw4w9WgXcQ",benefit:"Mental imagery. Deep connection.",solution:"Uses visualization for better muscle connection.",gender:"both"},
{ id:"M2",name:"Elevator Visualization",description:"Mental floor-by-floor control",category:"mindfulness",subcategory:"imagery",difficulty:"intermediate",duration:"4:15",reps:"6 elevator rides",videoCode:"dQw4w9WgXcQ",benefit:"Mental control. Precision imagery.",solution:"Mental rehearsal for precise control.",gender:"both"},
{ id:"M3",name:"Root Energy Awareness",description:"Energy flow visualization",category:"mindfulness",subcategory:"imagery",difficulty:"advanced",duration:"4:45",reps:"5 energy flows",videoCode:"dQw4w9WgXcQ",benefit:"Energetic awareness. Vitality.",solution:"Combines physical and energetic awareness.",gender:"both"},
{ id:"M4",name:"Sensory Focus Meditation",description:"Focus on muscle sensations",category:"mindfulness",subcategory:"meditative",difficulty:"beginner",duration:"4:00",reps:"5 min focus",videoCode:"dQw4w9WgXcQ",benefit:"Sensory awareness. Mindful connection.",solution:"Develops sensory awareness of pelvic area.",gender:"both"},
{ id:"M5",name:"Body Scan Integration",description:"Full body awareness",category:"mindfulness",subcategory:"meditative",difficulty:"intermediate",duration:"5:15",reps:"1 full scan",videoCode:"dQw4w9WgXcQ",benefit:"Whole-body integration. Complete awareness.",solution:"Integrates pelvic awareness with whole body.",gender:"both"},
{ id:"M6",name:"Mindful Contraction Practice",description:"Conscious contraction training",category:"mindfulness",subcategory:"meditative",difficulty:"intermediate",duration:"4:30",reps:"10 mindful reps",videoCode:"dQw4w9WgXcQ",benefit:"Conscious control. Mindful practice.",solution:"Develops conscious control over contractions.",gender:"both"},
{ id:"M7",name:"Visualization Mastery",description:"Advanced visualization techniques",category:"mindfulness",subcategory:"imagery",difficulty:"advanced",duration:"5:20",reps:"6 mastery visualizations",videoCode:"dQw4w9WgXcQ",benefit:"Advanced visualization. Deep connection.",solution:"Master-level visualization techniques.",gender:"both"},
{ id:"M8",name:"Meditative Release Practice",description:"Mindful relaxation techniques",category:"mindfulness",subcategory:"meditative",difficulty:"beginner",duration:"4:10",reps:"8 release cycles",videoCode:"dQw4w9WgXcQ",benefit:"Mindful relaxation. Stress reduction.",solution:"Teaches mindful relaxation of pelvic muscles.",gender:"both"}
],

hybrid:[
{ id:"H1",name:"Kegel + Plank Fusion",description:"Combines with core plank",category:"hybrid",subcategory:"core-integrated",difficulty:"advanced",duration:"5:00",reps:"3 × 30s fusions",videoCode:"dQw4w9WgXcQ",benefit:"Core integration. Whole-body strength.",solution:"Integrates pelvic and core strength.",gender:"both"},
{ id:"H2",name:"Kegel + Squat Combo",description:"Integrates with squat movement",category:"hybrid",subcategory:"core-integrated",difficulty:"intermediate",duration:"4:30",reps:"10 combo reps",videoCode:"dQw4w9WgXcQ",benefit:"Functional strength. Real-world application.",solution:"Combines pelvic strength with leg movement.",gender:"both"},
{ id:"H3",name:"Kegel + Bridge Integration",description:"Combines with glute bridge",category:"hybrid",subcategory:"core-integrated",difficulty:"intermediate",duration:"4:45",reps:"8 bridge reps",videoCode:"dQw4w9WgXcQ",benefit:"Glute-pelvic coordination. Posterior chain.",solution:"Coordinates pelvic and glute muscles.",gender:"both"},
{ id:"H4",name:"Jump Control Training",description:"Maintains engagement during jumps",category:"hybrid",subcategory:"dynamic-load",difficulty:"advanced",duration:"5:30",reps:"8 jump sequences",videoCode:"dQw4w9WgXcQ",benefit:"Impact control. Athletic stability.",solution:"Trains pelvic control during impact.",gender:"both"},
{ id:"H5",name:"Athletic Stability Protocol",description:"For sports performance",category:"hybrid",subcategory:"dynamic-load",difficulty:"advanced",duration:"6:00",reps:"6 athletic reps",videoCode:"dQw4w9WgXcQ",benefit:"Sports performance. Athletic control.",solution:"Specifically for athletic performance.",gender:"both"},
{ id:"H6",name:"Dynamic Movement Integration",description:"Kegels during dynamic movements",category:"hybrid",subcategory:"dynamic-load",difficulty:"advanced",duration:"5:45",reps:"8 dynamic reps",videoCode:"dQw4w9WgXcQ",benefit:"Dynamic control. Movement integration.",solution:"Integrates kegels with dynamic movements.",gender:"both"},
{ id:"H7",name:"Multi-Muscle Coordination",description:"Coordinates multiple muscle groups",category:"hybrid",subcategory:"core-integrated",difficulty:"advanced",duration:"5:15",reps:"6 coordination reps",videoCode:"dQw4w9WgXcQ",benefit:"Muscle coordination. Integrated function.",solution:"Trains coordination between multiple muscle groups.",gender:"both"},
{ id:"H8",name:"Functional Fitness Fusion",description:"Combines with functional fitness",category:"hybrid",subcategory:"core-integrated",difficulty:"intermediate",duration:"4:55",reps:"10 fusion reps",videoCode:"dQw4w9WgXcQ",benefit:"Functional fitness. Practical application.",solution:"Integrates pelvic training with functional fitness.",gender:"both"}
],

relaxation:[
{ id:"RL1",name:"Pelvic Drop Release",description:"Complete muscle relaxation",category:"relaxation",subcategory:"reverse",difficulty:"beginner",duration:"3:30",reps:"8 release cycles",videoCode:"dQw4w9WgXcQ",benefit:"Muscle relaxation. Tension release.",solution:"Essential for overactive pelvic floor.",gender:"both"},
{ id:"RL2",name:"Reverse Kegel Push",description:"Gentle outward pressure",category:"relaxation",subcategory:"reverse",difficulty:"intermediate",duration:"4:00",reps:"10 reverse pushes",videoCode:"dQw4w9WgXcQ",benefit:"Balance training. Relaxation skill.",solution:"Trains relaxation response in pelvic muscles.",gender:"both"},
{ id:"RL3",name:"Stretch-Based Release",description:"Combines with stretching",category:"relaxation",subcategory:"lengthening",difficulty:"beginner",duration:"4:30",reps:"6 stretch-holds",videoCode:"dQw4w9WgXcQ",benefit:"Muscle lengthening. Flexibility.",solution:"Combines stretching with pelvic relaxation.",gender:"both"},
{ id:"RL4",name:"Pelvic Floor Massage",description:"Self-massage technique",category:"relaxation",subcategory:"lengthening",difficulty:"intermediate",duration:"5:15",reps:"Massage routine",videoCode:"dQw4w9WgXcQ",benefit:"Muscle release. Tension relief.",solution:"Self-massage for pelvic tension.",gender:"both"},
{ id:"RL5",name:"Complete Let-Go Training",description:"Total relaxation protocol",category:"relaxation",subcategory:"reverse",difficulty:"beginner",duration:"4:45",reps:"5 let-go cycles",videoCode:"dQw4w9WgXcQ",benefit:"Deep relaxation. Stress relief.",solution:"Complete protocol for pelvic relaxation.",gender:"both"},
{ id:"RL6",name:"Deep Relaxation Protocol",description:"Advanced relaxation techniques",category:"relaxation",subcategory:"reverse",difficulty:"intermediate",duration:"5:30",reps:"6 deep relaxation cycles",videoCode:"dQw4w9WgXcQ",benefit:"Deep relaxation. Stress management.",solution:"Advanced techniques for deep relaxation.",gender:"both"},
{ id:"RL7",name:"Tension Release Mastery",description:"Master-level tension release",category:"relaxation",subcategory:"lengthening",difficulty:"advanced",duration:"6:00",reps:"5 mastery releases",videoCode:"dQw4w9WgXcQ",benefit:"Complete tension release. Mastery level.",solution:"Master-level techniques for tension release.",gender:"both"},
{ id:"RL8",name:"Mind-Body Relaxation",description:"Holistic relaxation approach",category:"relaxation",subcategory:"reverse",difficulty:"intermediate",duration:"5:10",reps:"8 mind-body cycles",videoCode:"dQw4w9WgXcQ",benefit:"Holistic relaxation. Mind-body connection.",solution:"Combines mental and physical relaxation.",gender:"both"}
]
    };

    // ==================== 50 COMPLETE ASSESSMENT QUESTIONS ====================
    const questions = [
        {
            id: 1,
            text: "What is your biological gender?",
            options: ["Male", "Female"],
            category: "demographic",
            scoreMap: { "Male": 0, "Female": 0 }
        },
        {
            id: 2,
            text: "What is your current age?",
            options: ["Under 25", "25-34", "35-44", "45-54", "55-64", "65+"],
            category: "demographic",
            scoreMap: { "Under 25": 0, "25-34": 5, "35-44": 10, "45-54": 15, "55-64": 20, "65+": 25 }
        },
        {
            id: 3,
            text: "Have you been pregnant? (Females only)",
            options: ["Never", "1 pregnancy", "2 pregnancies", "3+ pregnancies", "Currently pregnant"],
            category: "demographic",
            scoreMap: { "Never": 0, "1 pregnancy": 10, "2 pregnancies": 15, "3+ pregnancies": 20, "Currently pregnant": 25 },
            skipIfGender: "Male"
        },
        {
            id: 4,
            text: "Have you had any pelvic surgeries?",
            options: ["None", "C-section", "Hysterectomy", "Prostate surgery", "Other pelvic surgery"],
            category: "demographic",
            scoreMap: { "None": 0, "C-section": 15, "Hysterectomy": 20, "Prostate surgery": 25, "Other pelvic surgery": 15 }
        },
        {
            id: 5,
            text: "Any chronic health conditions?",
            options: ["None", "Diabetes", "Hypertension", "Back problems", "Multiple conditions"],
            category: "demographic",
            scoreMap: { "None": 0, "Diabetes": 10, "Hypertension": 10, "Back problems": 15, "Multiple conditions": 25 }
        },

        // Section 2: Symptoms & Problems (10 questions)
        {
            id: 6,
            text: "Do you experience urine leakage?",
            options: ["Never", "Rarely (few times/year)", "Sometimes (monthly)", "Often (weekly)", "Daily"],
            category: "symptoms",
            scoreMap: { "Never": 0, "Rarely (few times/year)": 10, "Sometimes (monthly)": 20, "Often (weekly)": 30, "Daily": 40 }
        },
        {
            id: 7,
            text: "When does leakage usually occur?",
            options: ["No leakage", "When coughing/sneezing", "During exercise", "With urgency", "All the time"],
            category: "symptoms",
            scoreMap: { "No leakage": 0, "When coughing/sneezing": 15, "During exercise": 20, "With urgency": 25, "All the time": 35 }
        },
        {
            id: 8,
            text: "How many times do you urinate at night?",
            options: ["0 times", "1 time", "2 times", "3 times", "4+ times"],
            category: "symptoms",
            scoreMap: { "0 times": 0, "1 time": 5, "2 times": 10, "3 times": 20, "4+ times": 30 }
        },
        {
            id: 9,
            text: "Do you have sudden strong urges to urinate?",
            options: ["Never", "Rarely", "Sometimes", "Often", "Constantly"],
            category: "symptoms",
            scoreMap: { "Never": 0, "Rarely": 10, "Sometimes": 20, "Often": 30, "Constantly": 40 }
        },
        {
            id: 10,
            text: "Difficulty starting urine flow?",
            options: ["Never", "Occasionally", "Sometimes", "Often", "Always"],
            category: "symptoms",
            scoreMap: { "Never": 0, "Occasionally": 5, "Sometimes": 15, "Often": 25, "Always": 35 }
        },
        {
            id: 11,
            text: "Feeling of incomplete emptying?",
            options: ["Never", "Rarely", "Sometimes", "Often", "Always"],
            category: "symptoms",
            scoreMap: { "Never": 0, "Rarely": 5, "Sometimes": 15, "Often": 25, "Always": 35 }
        },
        {
            id: 12,
            text: "Any pelvic pain or discomfort?",
            options: ["None", "During/after sex", "When sitting", "Lower back pain", "Constant pain"],
            category: "symptoms",
            scoreMap: { "None": 0, "During/after sex": 15, "When sitting": 20, "Lower back pain": 25, "Constant pain": 35 }
        },
        {
            id: 13,
            text: "Pain during sexual intercourse?",
            options: ["Never", "Occasionally", "Sometimes", "Often", "Always painful"],
            category: "symptoms",
            scoreMap: { "Never": 0, "Occasionally": 10, "Sometimes": 20, "Often": 30, "Always painful": 40 }
        },
        {
            id: 14,
            text: "Do you experience constipation?",
            options: ["Never", "Occasionally", "Sometimes", "Often", "Chronic"],
            category: "symptoms",
            scoreMap: { "Never": 0, "Occasionally": 5, "Sometimes": 10, "Often": 20, "Chronic": 30 }
        },
        {
            id: 15,
            text: "Do you strain during bowel movements?",
            options: ["Never", "Occasionally", "Sometimes", "Often", "Always"],
            category: "symptoms",
            scoreMap: { "Never": 0, "Occasionally": 5, "Sometimes": 10, "Often": 20, "Always": 30 }
        },

        // Section 3: Lifestyle & Habits (10 questions)
        {
            id: 16,
            text: "What is your occupation?",
            options: ["Sedentary (desk job)", "Standing job", "Light physical", "Heavy physical", "Athlete"],
            category: "lifestyle",
            scoreMap: { "Sedentary (desk job)": 15, "Standing job": 10, "Light physical": 5, "Heavy physical": 20, "Athlete": 25 }
        },
        {
            id: 17,
            text: "Hours sitting per day?",
            options: ["< 4 hours", "4-8 hours", "8-10 hours", "10-12 hours", "> 12 hours"],
            category: "lifestyle",
            scoreMap: { "< 4 hours": 0, "4-8 hours": 10, "8-10 hours": 15, "10-12 hours": 20, "> 12 hours": 25 }
        },
        {
            id: 18,
            text: "Regular exercise routine?",
            options: ["None", "1-2 times/week", "3-4 times/week", "5+ times/week", "Athlete training"],
            category: "lifestyle",
            scoreMap: { "None": 20, "1-2 times/week": 10, "3-4 times/week": 5, "5+ times/week": 0, "Athlete training": 0 }
        },
        {
            id: 19,
            text: "Type of exercise you do?",
            options: ["None", "Walking", "Running", "Weight training", "High impact sports"],
            category: "lifestyle",
            scoreMap: { "None": 20, "Walking": 5, "Running": 15, "Weight training": 20, "High impact sports": 25 }
        },
        {
            id: 20,
            text: "Daily water intake?",
            options: ["< 1 liter", "1-2 liters", "2-3 liters", "3-4 liters", "> 4 liters"],
            category: "lifestyle",
            scoreMap: { "< 1 liter": 20, "1-2 liters": 10, "2-3 liters": 0, "3-4 liters": 0, "> 4 liters": 0 }
        },
        {
            id: 21,
            text: "Caffeine consumption?",
            options: ["None", "1 cup/day", "2-3 cups/day", "4-5 cups/day", "> 5 cups/day"],
            category: "lifestyle",
            scoreMap: { "None": 0, "1 cup/day": 5, "2-3 cups/day": 10, "4-5 cups/day": 20, "> 5 cups/day": 25 }
        },
        {
            id: 22,
            text: "Alcohol consumption?",
            options: ["None", "Occasionally", "Weekly", "Several times/week", "Daily"],
            category: "lifestyle",
            scoreMap: { "None": 0, "Occasionally": 5, "Weekly": 10, "Several times/week": 20, "Daily": 30 }
        },
        {
            id: 23,
            text: "Smoking or vaping?",
            options: ["Never", "Former smoker", "Occasionally", "Regular smoker", "Heavy smoker"],
            category: "lifestyle",
            scoreMap: { "Never": 0, "Former smoker": 10, "Occasionally": 15, "Regular smoker": 25, "Heavy smoker": 35 }
        },
        {
            id: 24,
            text: "Quality of sleep?",
            options: ["Excellent", "Good", "Fair", "Poor", "Very poor"],
            category: "lifestyle",
            scoreMap: { "Excellent": 0, "Good": 5, "Fair": 10, "Poor": 20, "Very poor": 30 }
        },
        {
            id: 25,
            text: "Stress level in daily life?",
            options: ["Very low", "Low", "Moderate", "High", "Very high"],
            category: "lifestyle",
            scoreMap: { "Very low": 0, "Low": 5, "Moderate": 10, "High": 20, "Very high": 30 }
        },

        // Section 4: Sexual Health (8 questions)
        {
            id: 26,
            text: "Satisfaction with sexual function?",
            options: ["Very satisfied", "Satisfied", "Neutral", "Dissatisfied", "Very dissatisfied"],
            category: "sexual",
            scoreMap: { "Very satisfied": 0, "Satisfied": 5, "Neutral": 10, "Dissatisfied": 20, "Very dissatisfied": 30 }
        },
        {
            id: 27,
            text: "Erection quality (Males)?",
            options: ["Excellent", "Good", "Fair", "Poor", "No erection"],
            category: "sexual",
            scoreMap: { "Excellent": 0, "Good": 5, "Fair": 15, "Poor": 25, "No erection": 35 },
            skipIfGender: "Female"
        },
        {
            id: 28,
            text: "Vaginal dryness (Females)?",
            options: ["Never", "Occasionally", "Sometimes", "Often", "Always"],
            category: "sexual",
            scoreMap: { "Never": 0, "Occasionally": 5, "Sometimes": 15, "Often": 25, "Always": 35 },
            skipIfGender: "Male"
        },
        {
            id: 29,
            text: "Orgasm frequency?",
            options: ["Always", "Usually", "Sometimes", "Rarely", "Never"],
            category: "sexual",
            scoreMap: { "Always": 0, "Usually": 5, "Sometimes": 15, "Rarely": 25, "Never": 35 }
        },
        {
            id: 30,
            text: "Orgasm intensity?",
            options: ["Very intense", "Intense", "Moderate", "Mild", "No orgasm"],
            category: "sexual",
            scoreMap: { "Very intense": 0, "Intense": 5, "Moderate": 15, "Mild": 25, "No orgasm": 35 }
        },
        {
            id: 31,
            text: "Sexual desire/libido?",
            options: ["Very high", "High", "Moderate", "Low", "Very low"],
            category: "sexual",
            scoreMap: { "Very high": 0, "High": 5, "Moderate": 10, "Low": 20, "Very low": 30 }
        },
        {
            id: 32,
            text: "Pain after intercourse?",
            options: ["Never", "Rarely", "Sometimes", "Often", "Always"],
            category: "sexual",
            scoreMap: { "Never": 0, "Rarely": 5, "Sometimes": 15, "Often": 25, "Always": 35 }
        },
        {
            id: 33,
            text: "Confidence in sexual performance?",
            options: ["Very confident", "Confident", "Neutral", "Insecure", "Very insecure"],
            category: "sexual",
            scoreMap: { "Very confident": 0, "Confident": 5, "Neutral": 10, "Insecure": 20, "Very insecure": 30 }
        },

        // Section 5: Previous Experience & Goals (7 questions)
        {
            id: 34,
            text: "Previous pelvic floor exercise experience?",
            options: ["None", "Tried few times", "Occasional practice", "Regular practice", "Expert"],
            category: "experience",
            scoreMap: { "None": 20, "Tried few times": 10, "Occasional practice": 5, "Regular practice": 0, "Expert": 0 }
        },
        {
            id: 35,
            text: "Awareness of pelvic floor muscles?",
            options: ["No idea", "Vague idea", "Some awareness", "Good awareness", "Excellent awareness"],
            category: "experience",
            scoreMap: { "No idea": 20, "Vague idea": 10, "Some awareness": 5, "Good awareness": 0, "Excellent awareness": 0 }
        },
        {
            id: 36,
            text: "Primary goal for this program?",
            options: ["Stop leakage", "Improve sexual function", "Reduce pain", "General health", "All of above"],
            category: "goals",
            scoreMap: { "Stop leakage": 20, "Improve sexual function": 20, "Reduce pain": 20, "General health": 10, "All of above": 25 }
        },
        {
            id: 37,
            text: "Secondary goals?",
            options: ["Better bladder control", "Improved intimacy", "Pain relief", "Postpartum recovery", "Sports performance"],
            category: "goals",
            scoreMap: { "Better bladder control": 15, "Improved intimacy": 15, "Pain relief": 15, "Postpartum recovery": 20, "Sports performance": 10 }
        },
        {
            id: 38,
            text: "Time available daily for exercises?",
            options: ["5-10 minutes", "10-15 minutes", "15-20 minutes", "20-30 minutes", "30+ minutes"],
            category: "goals",
            scoreMap: { "5-10 minutes": 10, "10-15 minutes": 5, "15-20 minutes": 0, "20-30 minutes": 0, "30+ minutes": 0 }
        },
        {
            id: 39,
            text: "Willingness to commit to 30 days?",
            options: ["100% committed", "Very willing", "Moderately willing", "Somewhat willing", "Not sure"],
            category: "goals",
            scoreMap: { "100% committed": 0, "Very willing": 5, "Moderately willing": 10, "Somewhat willing": 20, "Not sure": 30 }
        },
        {
            id: 40,
            text: "Motivation level?",
            options: ["Extremely motivated", "Very motivated", "Moderately motivated", "Slightly motivated", "Not motivated"],
            category: "goals",
            scoreMap: { "Extremely motivated": 0, "Very motivated": 5, "Moderately motivated": 10, "Slightly motivated": 20, "Not motivated": 30 }
        },

        // Section 6: Medical & Specific Concerns (10 questions)
        {
            id: 41,
            text: "History of urinary tract infections?",
            options: ["Never", "1-2 times", "3-5 times", "6-10 times", "Frequent"],
            category: "medical",
            scoreMap: { "Never": 0, "1-2 times": 5, "3-5 times": 10, "6-10 times": 20, "Frequent": 30 }
        },
        {
            id: 42,
            text: "History of kidney stones?",
            options: ["Never", "Once", "2-3 times", "4+ times", "Chronic"],
            category: "medical",
            scoreMap: { "Never": 0, "Once": 5, "2-3 times": 10, "4+ times": 20, "Chronic": 30 }
        },
        {
            id: 43,
            text: "Prostate issues (Males)?",
            options: ["None", "Mild enlargement", "Moderate enlargement", "Severe enlargement", "Cancer history"],
            category: "medical",
            scoreMap: { "None": 0, "Mild enlargement": 10, "Moderate enlargement": 20, "Severe enlargement": 30, "Cancer history": 40 },
            skipIfGender: "Female"
        },
        {
            id: 44,
            text: "Menstrual issues (Females)?",
            options: ["None", "Mild cramps", "Moderate pain", "Severe pain", "Endometriosis"],
            category: "medical",
            scoreMap: { "None": 0, "Mild cramps": 5, "Moderate pain": 15, "Severe pain": 25, "Endometriosis": 35 },
            skipIfGender: "Male"
        },
        {
            id: 45,
            text: "History of prolapse?",
            options: ["None", "Mild", "Moderate", "Severe", "Surgery for prolapse"],
            category: "medical",
            scoreMap: { "None": 0, "Mild": 10, "Moderate": 20, "Severe": 30, "Surgery for prolapse": 40 }
        },
        {
            id: 46,
            text: "Medications affecting urination?",
            options: ["None", "Diuretics", "Blood pressure meds", "Antidepressants", "Multiple medications"],
            category: "medical",
            scoreMap: { "None": 0, "Diuretics": 10, "Blood pressure meds": 15, "Antidepressants": 20, "Multiple medications": 30 }
        },
        {
            id: 47,
            text: "Allergies affecting pelvic area?",
            options: ["None", "Mild", "Moderate", "Severe", "Multiple allergies"],
            category: "medical",
            scoreMap: { "None": 0, "Mild": 5, "Moderate": 15, "Severe": 25, "Multiple allergies": 35 }
        },
        {
            id: 48,
            text: "Recent weight changes?",
            options: ["Stable", "Gained 5-10 lbs", "Gained 10+ lbs", "Lost 5-10 lbs", "Lost 10+ lbs"],
            category: "medical",
            scoreMap: { "Stable": 0, "Gained 5-10 lbs": 10, "Gained 10+ lbs": 20, "Lost 5-10 lbs": 5, "Lost 10+ lbs": 10 }
        },
        {
            id: 49,
            text: "Family history of pelvic issues?",
            options: ["None", "Mother", "Sister", "Multiple relatives", "Strong family history"],
            category: "medical",
            scoreMap: { "None": 0, "Mother": 10, "Sister": 15, "Multiple relatives": 20, "Strong family history": 25 }
        },
        {
            id: 50,
            text: "Previous physical therapy?",
            options: ["Never", "Few sessions", "Completed program", "Multiple programs", "Currently in therapy"],
            category: "medical",
            scoreMap: { "Never": 0, "Few sessions": 5, "Completed program": 10, "Multiple programs": 20, "Currently in therapy": 30 }
        }
    ];

    // ==================== CORE APP LOGIC ====================
    let youtubePlayer = null;
    let videoCheckInterval = null;
    let currentVideoId = null;
    
    function initApp() {
        const hasSavedData = loadState();
        
        if (hasSavedData) {
            if (appState.assessmentComplete) {
                showExercisePlan();
            } else {
                renderQuestion();
            }
        } else {
            renderQuestion();
        }
    }

    function renderQuestion() {
        // Skip gender-specific questions
        while (appState.currentQuestion < questions.length) {
            const q = questions[appState.currentQuestion];
            
            // Check if we should skip this question based on gender
            if (q.skipIfGender && appState.gender === q.skipIfGender) {
                appState.currentQuestion++;
                continue;
            }
            
            break;
        }
        
        if (appState.currentQuestion >= questions.length) {
            completeAssessment();
            return;
        }

        const q = questions[appState.currentQuestion];
        document.getElementById('question-text').textContent = q.text;
        document.getElementById('question-counter').textContent = `${appState.currentQuestion + 1}/${questions.length}`;
        
        const progress = ((appState.currentQuestion) / questions.length) * 100;
        document.getElementById('progress-bar').style.width = `${progress}%`;

        const container = document.getElementById('options-container');
        container.innerHTML = '';

        q.options.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = "w-full option-btn p-4 rounded-xl text-sm font-semibold text-left text-white flex justify-between items-center fade-in";
            btn.innerHTML = `<span>${opt}</span><i class="far fa-circle text-gold-primary/30"></i>`;
            btn.onclick = () => handleAnswer(opt);
            container.appendChild(btn);
        });

        saveState();
    }

    function handleAnswer(answer) {
        const currentQ = questions[appState.currentQuestion];
        
        if (currentQ.id === 1) {
            appState.gender = answer;
        }
        
        // Store answer in user profile
        appState.userProfile[`q${currentQ.id}`] = answer;
        
        // Update category scores using scoreMap
        if (currentQ.scoreMap && currentQ.scoreMap[answer] !== undefined) {
            const category = currentQ.category;
            if (!appState.categoryScores[category]) {
                appState.categoryScores[category] = 0;
            }
            appState.categoryScores[category] += currentQ.scoreMap[answer];
        }
        
        // Update specific scores based on question
        if (currentQ.id >= 6 && currentQ.id <= 10) {
            if (answer.includes("Daily") || answer.includes("Often") || answer.includes("Always")) {
                appState.scores.leakage += 15;
            }
        }
        
        appState.currentQuestion++;
        renderQuestion();
    }

    function calculateScores() {
        // Calculate total scores
        let totalScore = 0;
        let maxPossible = 0;
        
        // Calculate maximum possible scores for each category
        const categoryMax = {};
        questions.forEach(q => {
            if (!categoryMax[q.category]) categoryMax[q.category] = 0;
            const maxValue = Math.max(...Object.values(q.scoreMap));
            categoryMax[q.category] += maxValue;
        });
        
        // Calculate percentages for each category
        const categoryPercentages = {};
        for (const category in appState.categoryScores) {
            if (categoryMax[category] > 0) {
                categoryPercentages[category] = (appState.categoryScores[category] / categoryMax[category]) * 100;
            } else {
                categoryPercentages[category] = 0;
            }
        }
        
        // Calculate final scores
        const focusScore = Math.round(
            (categoryPercentages.demographic + categoryPercentages.symptoms + categoryPercentages.medical) / 3
        );
        
        const urgencyScore = Math.round(
            (categoryPercentages.symptoms * 0.7 + categoryPercentages.medical * 0.3)
        );
        
        const programScore = Math.round(
            (categoryPercentages.sexual * 0.4 + categoryPercentages.experience * 0.3 + categoryPercentages.goals * 0.3)
        );
        
        return {
            focus: Math.min(100, Math.max(0, focusScore)),
            urgency: Math.min(100, Math.max(0, urgencyScore)),
            program: Math.min(100, Math.max(0, programScore))
        };
    }

    function completeAssessment() {
        appState.assessmentComplete = true;
        document.getElementById('quiz-section').classList.add('hidden');
        document.getElementById('progress-section').classList.add('hidden');
        document.getElementById('analysis-section').classList.remove('hidden');
        
        generate30DayProgram();
        
        // Calculate and animate scores
        const scores = calculateScores();
        
        animateScore('focus-score', scores.focus);
        animateScore('urgency-score', scores.urgency);
        animateScore('program-score', scores.program);
        
        // Generate personalized analysis text
        let focusArea = "";
        if (scores.urgency > 70) {
            focusArea = "Urgent Rehabilitation";
        } else if (scores.focus > 70) {
            focusArea = "Advanced Strengthening";
        } else if (scores.program > 60) {
            focusArea = "Comprehensive Development";
        } else {
            focusArea = "Foundational Training";
        }
        
        document.getElementById('analysis-text').textContent = 
            `Based on your ${appState.gender || "personal"} profile, we've designed a specialized ${focusArea} protocol. ` +
            `Your assessment shows ${scores.focus}% focus on core issues, ${scores.urgency}% urgency level, ` +
            `and a ${scores.program}% match with our optimal protocol. The 30-day program targets your specific needs ` +
            `with gender-appropriate exercises for measurable improvement.`;
        
        saveState();
    }

    function generate30DayProgram() {
        if (Object.keys(appState.dayExercises).length > 0) return;

        const gender = appState.gender || "Female";
        const scores = calculateScores();
        
        // Determine program focus based on scores
        let primaryFocus = "control";
        let secondaryFocus = "functional";
        
        if (scores.urgency > 70) {
            primaryFocus = "rehab";
            secondaryFocus = "control";
        } else if (scores.focus > 60) {
            primaryFocus = "control";
            secondaryFocus = "strength";
        }
        
        for (let day = 1; day <= 30; day++) {
            let dayExercises = [];
            
            // Day 1-10: Foundation phase
            if (day <= 10) {
                dayExercises = getExercisesForPhase("foundation", gender, day);
            }
            // Day 11-20: Development phase
            else if (day <= 20) {
                dayExercises = getExercisesForPhase("development", gender, day);
            }
            // Day 21-30: Mastery phase
            else {
                dayExercises = getExercisesForPhase("mastery", gender, day);
            }
            
            appState.dayExercises[day] = dayExercises;
            appState.dayProgress[day] = [];
        }
    }

    function getExercisesForPhase(phase, gender, day) {
        const exercises = [];
        const genderFilter = ex => ex.gender === "both" || ex.gender === gender;
        
        if (phase === "foundation") {
            // 2 functional, 1 control, 1 breathing, 1 relaxation, 1 mindfulness
            const functional = shuffle([...exerciseLibrary.functional].filter(genderFilter)).slice(0, 2);
            const control = shuffle([...exerciseLibrary.control].filter(genderFilter)).slice(0, 1);
            const breathing = shuffle([...exerciseLibrary.breathing].filter(genderFilter)).slice(0, 1);
            const relaxation = shuffle([...exerciseLibrary.relaxation].filter(genderFilter)).slice(0, 1);
            const mindfulness = shuffle([...exerciseLibrary.mindfulness].filter(genderFilter)).slice(0, 1);
            
            exercises.push(...functional, ...control, ...breathing, ...relaxation, ...mindfulness);
        }
        else if (phase === "development") {
            // 1 functional, 2 control, 1 sexual, 1 hybrid, 1 endurance
            const functional = shuffle([...exerciseLibrary.functional].filter(genderFilter)).slice(0, 1);
            const control = shuffle([...exerciseLibrary.control].filter(genderFilter)).slice(0, 2);
            const sexual = shuffle([...exerciseLibrary.sexual].filter(genderFilter)).slice(0, 1);
            const hybrid = shuffle([...exerciseLibrary.hybrid].filter(genderFilter)).slice(0, 1);
            const endurance = shuffle([...exerciseLibrary.endurance].filter(genderFilter)).slice(0, 1);
            
            exercises.push(...functional, ...control, ...sexual, ...hybrid, ...endurance);
        }
        else { // mastery
            // 1 control, 1 sexual, 1 hybrid, 1 rehab, 1 endurance, 1 advanced
            const control = shuffle([...exerciseLibrary.control].filter(genderFilter)).slice(0, 1);
            const sexual = shuffle([...exerciseLibrary.sexual].filter(genderFilter)).slice(0, 1);
            const hybrid = shuffle([...exerciseLibrary.hybrid].filter(genderFilter)).slice(0, 1);
            const rehab = shuffle([...exerciseLibrary.rehab].filter(genderFilter)).slice(0, 1);
            const endurance = shuffle([...exerciseLibrary.endurance].filter(genderFilter)).slice(0, 1);
            
            // For advanced, pick from any category but ensure difficulty is intermediate or advanced
            const allExercises = [
                ...exerciseLibrary.control,
                ...exerciseLibrary.hybrid,
                ...exerciseLibrary.endurance
            ].filter(ex => genderFilter(ex) && (ex.difficulty === "advanced" || ex.difficulty === "intermediate"));
            
            const advanced = shuffle(allExercises).slice(0, 1);
            
            exercises.push(...control, ...sexual, ...hybrid, ...rehab, ...endurance, ...advanced);
        }
        
        return shuffle(exercises).slice(0, 6); // Ensure exactly 6 exercises per day
    }

    function showExercisePlan() {
        document.getElementById('quiz-section').classList.add('hidden');
        document.getElementById('analysis-section').classList.add('hidden');
        document.getElementById('progress-section').classList.add('hidden');
        document.getElementById('exercise-section').classList.remove('hidden');
        
        if (Object.keys(appState.dayExercises).length === 0) {
            generate30DayProgram();
        }
        
        renderExerciseList();
        saveState();
    }

    function renderExerciseList() {
        const list = document.getElementById('exercise-list');
        list.innerHTML = '';
        
        const day = appState.currentDay;
        document.getElementById('current-day').textContent = day;
        
        const exercises = appState.dayExercises[day] || [];
        const completed = appState.dayProgress[day] || [];
        
        document.getElementById('completion-stats').textContent = `${completed.length}/${exercises.length} Completed`;

        exercises.forEach((ex, idx) => {
            const isDone = completed.includes(ex.id);
            const isCurrent = idx === completed.length;
            const isLocked = idx > completed.length;

            const card = document.createElement('div');
            card.className = `exercise-card p-4 rounded-xl flex items-center gap-4 ${isLocked ? 'locked' : ''} ${isCurrent ? 'current' : ''} ${isDone ? 'completed' : ''} fade-in`;
            card.innerHTML = `
                <div class="w-8 h-8 rounded-full flex items-center justify-center font-bold ${isDone ? 'bg-green-500 text-white' : 'bg-gold-primary text-black'}">
                    ${isDone ? '<i class="fas fa-check"></i>' : idx + 1}
                </div>
                <div class="flex-1">
                    <h4 class="text-sm font-bold text-white">${ex.name}</h4>
                    <p class="text-[10px] text-gray-500 uppercase font-bold">${ex.category} • ${ex.duration} • ${ex.difficulty}</p>
                </div>
                <i class="fas ${isLocked ? 'fa-lock text-gray-700' : 'fa-play-circle text-gold-primary text-xl'}"></i>
            `;
            
            if (!isLocked && !isDone) {
                card.onclick = () => openVideo(ex, idx);
            }
            list.appendChild(card);
        });
    }

    let activeEx = null;
    let videoCompleted = false;
    
    function openVideo(ex, idx) {
        activeEx = ex;
        videoCompleted = false;
        currentVideoId = ex.videoCode;
        
        document.getElementById('video-title').textContent = ex.name;
        document.getElementById('video-description').textContent = ex.description;
        document.getElementById('video-duration').textContent = ex.duration;
        document.getElementById('video-reps').textContent = ex.reps;
        document.getElementById('video-category').textContent = ex.category;
        
        const frame = document.getElementById('video-frame');
        frame.innerHTML = `
            <iframe 
                id="youtube-player"
                src="https://www.youtube.com/embed/${ex.videoCode}?enablejsapi=1&rel=0&modestbranding=1&playsinline=1" 
                frameborder="0" 
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                allowfullscreen>
            </iframe>`;
        
        // Reset video progress
        document.getElementById('video-progress-fill').style.width = '0%';
        document.getElementById('video-time-current').textContent = '0:00';
        document.getElementById('video-time-total').textContent = '0:00';
        
        // Disable complete button initially
        const completeBtn = document.getElementById('complete-btn');
        const completeBtnText = document.getElementById('complete-btn-text');
        const videoLoading = document.getElementById('video-loading');
        
        completeBtn.disabled = true;
        completeBtnText.textContent = 'VIDEO MUST BE COMPLETED FIRST';
        videoLoading.classList.remove('hidden');
        
        document.getElementById('video-modal').classList.remove('hidden');
        
        // Load YouTube API if not already loaded
        if (!window.YT) {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }
        
        // Initialize YouTube player
        window.onYouTubeIframeAPIReady = function() {
            youtubePlayer = new YT.Player('youtube-player', {
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        };
        
        // If API is already loaded
        if (window.YT && YT.Player) {
            youtubePlayer = new YT.Player('youtube-player', {
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        }
        
        // Start checking video progress
        if (videoCheckInterval) clearInterval(videoCheckInterval);
        videoCheckInterval = setInterval(checkVideoProgress, 1000);
    }

    function onPlayerReady(event) {
        document.getElementById('video-loading').classList.add('hidden');
        const duration = event.target.getDuration();
        const minutes = Math.floor(duration / 60);
        const seconds = Math.floor(duration % 60);
        document.getElementById('video-time-total').textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
    }

    function onPlayerStateChange(event) {
        if (event.data === YT.PlayerState.ENDED) {
            videoCompleted = true;
            const completeBtn = document.getElementById('complete-btn');
            const completeBtnText = document.getElementById('complete-btn-text');
            
            completeBtn.disabled = false;
            completeBtnText.textContent = 'MARK AS COMPLETE';
            document.getElementById('video-progress-fill').style.width = '100%';
        }
    }

    function checkVideoProgress() {
        if (youtubePlayer && youtubePlayer.getCurrentTime && youtubePlayer.getDuration) {
            const currentTime = youtubePlayer.getCurrentTime();
            const duration = youtubePlayer.getDuration();
            
            if (duration > 0) {
                const progressPercent = (currentTime / duration) * 100;
                document.getElementById('video-progress-fill').style.width = `${progressPercent}%`;
                
                // Update current time display
                const minutes = Math.floor(currentTime / 60);
                const seconds = Math.floor(currentTime % 60);
                document.getElementById('video-time-current').textContent = 
                    `${minutes}:${seconds.toString().padStart(2, '0')}`;
                
                // Enable complete button if 95% watched
                if (progressPercent >= 95 && !videoCompleted) {
                    videoCompleted = true;
                    const completeBtn = document.getElementById('complete-btn');
                    const completeBtnText = document.getElementById('complete-btn-text');
                    
                    completeBtn.disabled = false;
                    completeBtnText.textContent = 'MARK AS COMPLETE';
                }
            }
        }
    }

    function markCurrentExerciseComplete() {
        if (!activeEx || !videoCompleted) return;
        
        const day = appState.currentDay;
        if (!appState.dayProgress[day].includes(activeEx.id)) {
            appState.dayProgress[day].push(activeEx.id);
        }

        // Auto move to next day if finished
        if (appState.dayProgress[day].length === appState.dayExercises[day].length && day < 30) {
            appState.currentDay++;
        }

        closeVideoModal();
        renderExerciseList();
        saveState();
    }

    function closeVideoModal() {
        if (videoCheckInterval) {
            clearInterval(videoCheckInterval);
            videoCheckInterval = null;
        }
        
        if (youtubePlayer) {
            youtubePlayer.stopVideo();
            youtubePlayer = null;
        }
        
        document.getElementById('video-modal').classList.add('hidden');
        document.getElementById('video-frame').innerHTML = '';
        activeEx = null;
        videoCompleted = false;
    }

    function restartAssessment() {
        if(confirm("This will clear all progress and start fresh. Continue?")) {
            localStorage.removeItem('STI_KEGAL_PRO_DATA');
            location.reload();
        }
    }

    // ==================== UTILS ====================
    function shuffle(array) { 
        const shuffled = [...array];
        for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
    }
    
    function animateScore(id, target) {
        let cur = 0;
        const el = document.getElementById(id);
        const iv = setInterval(() => {
            cur += 2;
            if (cur >= target) { 
                el.textContent = target + '%'; 
                clearInterval(iv); 
            }
            else { 
                el.textContent = cur + '%'; 
            }
        }, 20);
    }

    // Ensure YouTube API is available
    window.onYouTubeIframeAPIReady = function() {
        // This will be called by YouTube API
    };

    window.onload = initApp;
</script>
</body>
</html>
